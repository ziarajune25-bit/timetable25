{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2>All Subjects</h2>
    
    <a href="/admin" class="btn btn-secondary mb-3">Back to Dashboard</a>
    
    {% if subjects_by_year.I or subjects_by_year.II or subjects_by_year.III or subjects_by_year.IV %}
    
    <!-- YEAR I -->
    {% if subjects_by_year.I %}
    <div class="year-section">
        <h3 style="border-bottom: 2px solid #0a3d62; padding-bottom: 10px; margin-top: 30px;">Year I</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Code</th>
                    <th>Name</th>
                    <th>Course</th>
                    <th>Semester</th>
                    <th>Weekly Hours</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for subject in subjects_by_year.I %}
                <tr>
                    <td><strong>{{ subject.code }}</strong></td>
                    <td>{{ subject.name }}</td>
                    <td>{{ subject.course_name }}</td>
                    <td>{{ subject.semester }}</td>
                    <td>{{ subject.weekly_hours }}</td>
                    <td>
                        <a href="/edit_subject/{{ subject.id }}" class="btn btn-sm btn-primary">Edit</a>
                        <button onclick="deleteSubject({{ subject.id }})" class="btn btn-sm btn-danger">Delete</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}

    <!-- YEAR II -->
    {% if subjects_by_year.II %}
    <div class="year-section">
        <h3 style="border-bottom: 2px solid #0a3d62; padding-bottom: 10px; margin-top: 30px;">Year II</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Code</th>
                    <th>Name</th>
                    <th>Course</th>
                    <th>Semester</th>
                    <th>Weekly Hours</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for subject in subjects_by_year.II %}
                <tr>
                    <td><strong>{{ subject.code }}</strong></td>
                    <td>{{ subject.name }}</td>
                    <td>{{ subject.course_name }}</td>
                    <td>{{ subject.semester }}</td>
                    <td>{{ subject.weekly_hours }}</td>
                    <td>
                        <a href="/edit_subject/{{ subject.id }}" class="btn btn-sm btn-primary">Edit</a>
                        <button onclick="deleteSubject({{ subject.id }})" class="btn btn-sm btn-danger">Delete</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}

    <!-- YEAR III -->
    {% if subjects_by_year.III %}
    <div class="year-section">
        <h3 style="border-bottom: 2px solid #0a3d62; padding-bottom: 10px; margin-top: 30px;">Year III</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Code</th>
                    <th>Name</th>
                    <th>Course</th>
                    <th>Semester</th>
                    <th>Weekly Hours</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for subject in subjects_by_year.III %}
                <tr>
                    <td><strong>{{ subject.code }}</strong></td>
                    <td>{{ subject.name }}</td>
                    <td>{{ subject.course_name }}</td>
                    <td>{{ subject.semester }}</td>
                    <td>{{ subject.weekly_hours }}</td>
                    <td>
                        <a href="/edit_subject/{{ subject.id }}" class="btn btn-sm btn-primary">Edit</a>
                        <button onclick="deleteSubject({{ subject.id }})" class="btn btn-sm btn-danger">Delete</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}

    <!-- YEAR IV -->
    {% if subjects_by_year.IV %}
    <div class="year-section">
        <h3 style="border-bottom: 2px solid #0a3d62; padding-bottom: 10px; margin-top: 30px;">Year IV</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Code</th>
                    <th>Name</th>
                    <th>Course</th>
                    <th>Semester</th>
                    <th>Weekly Hours</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for subject in subjects_by_year.IV %}
                <tr>
                    <td><strong>{{ subject.code }}</strong></td>
                    <td>{{ subject.name }}</td>
                    <td>{{ subject.course_name }}</td>
                    <td>{{ subject.semester }}</td>
                    <td>{{ subject.weekly_hours }}</td>
                    <td>
                        <a href="/edit_subject/{{ subject.id }}" class="btn btn-sm btn-primary">Edit</a>
                        <button onclick="deleteSubject({{ subject.id }})" class="btn btn-sm btn-danger">Delete</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}
    
    {% else %}
    <div class="alert alert-info">No subjects found.</div>
    {% endif %}
</div>

<script>
function deleteSubject(id) {
    if (confirm("Are you sure you want to delete this subject?")) {
        window.location.href = `/delete_subject/${id}`;
    }
}
</script>
{% endblock %}
